'use strict';
var findUp = require('find-up');
var readPkg = require('read-pkg');
var Symbol = require('symbol');
var fpSymbol = Symbol('package.json filepath');

function addFp(x, fp) {
	x[fpSymbol] = fp;
	return x;
}

module.exports = function (namespace, cwd) {
	return findUp('package.json', {cwd: cwd})
		.then(function (fp) {
			if (!namespace) {
				throw new TypeError('Expected a namespace');
			}

			if (!fp) {
				return addFp({}, fp);
			}

			return readPkg(fp, {normalize: false}).then(function (p